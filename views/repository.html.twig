{% extends 'layout.html.twig' %}

{% block content %}
<div class="col-lg-12 btnbar">
	<a href="{{ path('browser.repositories') }}" class="btn btn-default">
		<span class="glyphicon glyphicon-chevron-left"></span> Go Back To Repositories
	</a>
</div>
<div id="sidebar">
	<div class="scrollable">
		<div class="col-lg-12">
		<h1 class="text-center">{{ repository }}</h1>

		<p class="lead text-center">
			{{ workspaces | length }} 
			{% if workspaces | length > 1 %}		
			workspaces
			{% else %}
			workspace
			{% endif %}
		</p>
		<fieldset>
			<legend>Create a new workspace</legend>
			<div class="alert alert-sm alert-info">
				<span class="glyphicon glyphicon-bullhorn"></span> If you choose a source workspace, it will be cloned into the new one.
			</div>
			<form action="{{ path('browser.workspace.create', { 'repository': repository } ) }}" method="post" role="form">
				<div class="form-group">
					<input type="text" name="name" placeholder="Name of the new workspace" class="form-control">
				</div>
				<div class="form-group">
					<select name="srcWorkspace" class="form-control">
					<option value="-1">Select a source workspace (optional)</option>
					{% for workspace in workspaces %}
						<option value="{{ workspace.name}}">{{ workspace.name }}</option>
					{% endfor %}
					</select>
				</div>
				<div class="form-group">
					<button type="submit" class="btn btn-primary">
						<span class="glyphicon glyphicon-plus"></span> Create a new workspace
					</button>
				</div>
			</form>
		</fieldset>
	</div>
	</div>
</div>
<div id="content">
	<div class="scrollable">
		<div class="col-lg-12">
		{% for workspace in workspaces %}
		<div class="col-lg-3">
			<div class="panel panel-info">
			  <div class="panel-heading">
			  	<span class="glyphicon glyphicon-briefcase"></span> Workspace
			  </div>
			  <div class="panel-body">
			    <p class="lead text-center">
			    	{{ workspace.name }}
			    </p>
			  </div>
			  <div class="panel-footer">
			  	<div class="row">
			  	<div class="col-lg-8">
				  	<a href="{{ path('browser.rootNode', { 'repository': repository, 'workspace': workspace.name } ) }}" class="btn btn-primary btn-block">		
				  		 Open
				  	</a>
			  	</div>
			  	<div class="col-lg-4">
			  		<a href="#deleteModal{{ workspace.name | url_encode }}" data-toggle="modal" class="btn btn-danger btn-block" title="Delete"><span class="glyphicon glyphicon-trash"></span></a>
			  	</div>
			  </div>
			  </div>
			</div>
		</div>
		{% endfor %}
		</div>
	</div>
</div>

{% for workspace in workspaces %}
<div class="modal" id="deleteModal{{ workspace.name | url_encode }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
<div class="modal-dialog">
<div class="modal-content">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h4 class="modal-title">Delete a workspace</h4>
  </div>
  <div class="modal-body">
  	<div class="alert alert-danger">
    	<p>If you delete the workspace {{ workspace.name }}, all its data will be definitively erased !</p>
	</div>
  </div>
  <div class="modal-footer">
  	<form action="{{ path('browser.workspace.delete', { 'repository': repository } ) }}" method="post" role="form">
  		<input type="hidden" name="name" value="{{ workspace.name }}">
	    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	    <input type="submit" class="btn btn-danger" value-"Delete">
	</form>
  </div>
</div><!-- /.modal-content -->
</div><!-- /.modal-dialog -->
</div><!-- /.modal -->
{% endfor %}
{% endblock content %}
