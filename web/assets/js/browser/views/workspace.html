<div ng-controller="mbWorkspaceCtrl">
  <div id="sidebar" data-ng-controller="mbTreeCtrl">
      <div class="scrollable">
        <ul class="tree" id="tree">
           <li data-ng-repeat="node in currentNode.getReducedTree()" tree-node></li>
        </ul>
    </div>
  </div>
  <div id="content" >
    <div class="scrollable">
      <div id="first-load" data-ng-show="!_first_load">
        <span class="glyphicon glyphicon-refresh"></span>
        <p class="lead">Loading...</p>
      </div>
      <div data-ng-hide="!hasProperties() || !_first_load" id="property-search">
        <div class="input-group col-sm-12">
          <input data-ng-model="search" class="form-control" placeholder="Filter properties by name">
        </div>
      </div>
      <div id="property-content">
        <table class="table table-striped table-hover" data-ng-hide="!hasProperties() || !_first_load">
            <thead>
                <th>Property name</th>
                <th>Property value</th>
                <th>
                  <a href="#" class="pull-right" data-ng-click="setAddPropertyFormStatus(true)" data-ng-hide="showAddPropertyForm">
                    <span class="glyphicon glyphicon-plus"></span>
                  </a>
                  <a href="#" class="pull-right" data-ng-click="setAddPropertyFormStatus(false)" data-ng-show="showAddPropertyForm">
                    <span class="glyphicon glyphicon-minus"></span>
                  </a>
                </th>
            </thead>
            <tbody>
                <tr class="warning" data-ng-show="propertyToRestore" id="restoreAlert">
                  <td colspan=2 class="text-warning" style="vertical-align:middle;">
                    Property <span data-ng-bind="propertyDeleted.name"></span> has been deleted (<a href="#" class="text-warning" data-ng-click="confirmPropertyDeletion()">hide</a>)
                  </td>
                  <td>
                    <a data-ng-click="restoreProperty()" class="btn btn-warning btn-block">
                      <span class="glyphicon glyphicon-repeat"></span> Restore
                    </a>
                  </td>
                </tr>
                {% if 'node.property.create' in currentNode.support %}
                <tr class="active" data-ng-show="showAddPropertyForm">
                  <form action="#" method="post" role="form">
                  <td><input type="text" ng-model="newName" class="form-control" placeholder="Enter a name"></td>
                  <td><input type="text" ng-model="newValue" class="form-control" placeholder="Enter a value"></td>
                  <td>
                    <button type="button" class="btn btn-primary" data-ng-click="addProperty(newName,newValue)" data-ng-show="newName.length > 0 && newValue.length > 0">
                      <span class="glyphicon glyphicon-plus"></span> Create
                    </button>
                    <button type="button" class="btn btn-primary disabled" data-ng-hide="newName.length > 0 && newValue.length > 0">
                      <span class="glyphicon glyphicon-plus"></span> Create
                    </button>
                  </td>
                  </form>
                </tr>
                {% endif %}
                <tr class="property-item" data-ng-repeat="(name,value) in properties | propertyNameFilter:search | orderBy:'name'">
                  <td>
                    <span data-ng-bind="name"></span>
                  </td>
                  <td property-value></td>
                  <td class="property-options">
                    <div class="btn-group pull-right" data-ng-hide="name.slice(0,4) == 'jcr:'">
                      <a href="#" title="Edit" ng-click="propertyValueBtnForm.$show()" ng-hide="propertyValueBtnForm.$visible">
                      <span class="glyphicon glyphicon-pencil"></span>
                      </a>
                      {% if 'node.property.delete' in currentNode.support %}
                      <a href="#restoreAlert" data-ng-click="deleteProperty(name)" title="Delete">
                      <span class="glyphicon glyphicon-trash"></span>
                      </a>
                      {% endif %}
                    </div>
                  </td>
                </tr>
            </tbody>
        </table>
      </div>
    </div>
  </div>
</div>